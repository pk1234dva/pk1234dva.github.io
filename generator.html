<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3D pathfinding: How the generator works</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">3D pathfinding<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">a 3D pathfinding solution</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('generator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">How the generator works </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_doxygen_files_generator"></a>This is a quick conceptual summary of how generation of the svo object works, such as when using CreateSvoSynchronous. It is not meant to give a thorough explanation - its intended use is to give a guideline and overview of what happens for those of you (and myself) who want to understand the process in-depth. Looking at the source code and having some understanding of how general Svo approach works is required - see the Daniel Brewer talks or articles if you want to know more.</p>
<ol type="1">
<li>Various initialization is done - size and origin of the svo is setup, and a few other variables are setup.</li>
<li>All the unity Collider types in the scene are found, and their collider data (e.g. SphereCollider radius) as well as scene position (Transform data) are stored. For MeshColliders, the set of all the MeshCollider.sharedMesh and a map from MeshCollider to appropriate mesh is created. This is done so that if there's a thousand MeshColliders with the same mesh, we can only process the sharedMesh once, rather than once for each MeshCollider.</li>
<li>Inside NativeToColliderStructs, the data from 2 above is processed. This results in NativeArrays that contain world space position and world space "shape" data (e.g. world space radius of a sphere).</li>
<li>Voxelization of all the elements acquired in 3 is done using ColliderStructsToCodes. Morton codes of the colliding svo cells are set (these will be the colliding cells at the deepest layer once the svo is finished - e.g. each Morton code corresponds to one colliding cell). Estimates of the set sizes are done (this is necessary because parallel jobs do not allow for dynamic resizing), and then the NativeArray elements are processed using various collision tests (mostly SAT). The sets of Morton codes for all the collider types are then combined into one large set of Morton codes.</li>
<li>Using the set of all Morton codes at the deepest layer, we build up the upper layers of the svo using CodesToSvoLayers. This includes which parent cells are considered to be colliding and which not. If during this creation we come across a cell for which all 8 child cells are colliding, and they are all childless, we delete the 8 cells and instead set the parent cell as childless. This is done because if for example all 8 cells in the deepest layer that share a parent collide, it's largely redundant to store each of them - instead we "condense" them, marking the parent cell as childless.</li>
<li>We create the actual NativeArray that will store all the layers contiguously (e.g. layer at depth 0 -&gt; layer at depth 1, etc.). The native arrays are filled in using the layers from 5 above, in ascending order of Morton codes. Neighbors of cells linked using indices in this array itself - Morton codes are no longer stored, and instead the center of the respective cell is stored, together with the neighbor indices and whether the cell collides or not. This array is then returned, wrapped inside <a class="el" href="struct_svo_data.html" title="Svo container that has all the necessary data.">SvoData</a>. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="page_internals.html">Internals</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
